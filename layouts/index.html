{{/*  {{ define "main" }}
<h1>Latest Posts</h1>

<ul class="post-list">
{{ range .Paginator.Pages }}
    <li>
        <div class="post-date">{{ .Date.Format "January 2, 2006" }}</div>
        <h2 class="post-title">
            <a href="{{ .RelPermalink }}">{{ .Title }}</a>
        </h2>
        {{ if .Summary }}
        <div class="post-excerpt">{{ .Summary }}</div>
        {{ end }}
    </li>
{{ end }}
</ul>

{{ if gt .Paginator.TotalPages 1 }}
<nav class="pagination">
    {{ if .Paginator.HasPrev }}
        <a href="{{ .Paginator.Prev.URL | relURL }}">&larr; Newer</a>
    {{ end }}
    {{ if .Paginator.HasNext }}
        <a href="{{ .Paginator.Next.URL | relURL }}">Older &rarr;</a>
    {{ end }}
</nav>
{{ end }}
{{ end }}  */}}
{{ define "main" }}
<div class="homepage">
    <section class="intro">
        <p>Thinking about everything all the time.</p>
    </section>

    <section class="category-previews">
        {{ $categories := slice "opinion" "art-culture" "reviews" "diary" }}
        {{ range $categories }}
            {{ $categoryPages := where $.Site.Pages "Section" "posts" }}
            {{ $categoryPages = where $categoryPages ".Params.categories" "intersect" (slice .) }}
            {{ $latestPost := first 1 $categoryPages }}
            
            {{ if $latestPost }}
            <div class="category-section">
                <h2><a href="/categories/{{ . | urlize }}/">{{ . | title }}</a></h2>
                {{ range $latestPost }}
                <div class="post-preview">
                    <h3><a href="{{ .RelPermalink }}">{{ .Title }}</a></h3>
                    <div class="post-date">{{ .Date.Format "January 2, 2006" }}</div>
                    {{ if .Summary }}
                    <p class="post-excerpt">{{ .Summary | truncate 150 }}</p>
                    {{ end }}
                </div>
                {{ end }}
            </div>
            {{ end }}
        {{ end }}
    </section>

    <section class="all-posts-link">
        <p><a href="/posts/">View all posts â†’</a></p>
    </section>
</div>
{{ end }}